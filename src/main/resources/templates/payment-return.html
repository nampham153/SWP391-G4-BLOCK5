<!-- templates/payment-return.html -->
<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <title>Kết quả thanh toán VNPay</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
        :root{
            --bg:#f5f7fb;
            --card:#ffffff;
            --text:#0f172a;           /* slate-900 */
            --muted:#64748b;          /* slate-500 */
            --border:#e2e8f0;         /* slate-200 */
            --success:#16a34a;        /* green-600 */
            --success-soft:#e9f9ef;
            --error:#dc2626;          /* red-600 */
            --error-soft:#fdecec;
            --primary:#2563eb;        /* blue-600 */
            --shadow:0 10px 30px rgba(2,6,23,.08);
            --radius:16px;

            /* adjust if your navbar/footer are fixed; tweak as needed */
            --navbar-h:72px;
            --footer-h:72px;
        }

        *{box-sizing:border-box}
        html,body{height:100%}
        body{
            margin:0;
            font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans", Arial, sans-serif;
            color:var(--text);
            background:
                    radial-gradient(60rem 60rem at 10% -10%, #e8efff, transparent 40%),
                    radial-gradient(50rem 50rem at 110% 10%, #ffe8ea, transparent 35%),
                    var(--bg);
        }

        /* Page shell: header → main → footer */
        .page-shell{
            min-height:100dvh;
            display:flex;
            flex-direction:column;
        }

        /* Center the card inside main, not the entire body */
        .main-center{
            flex:1;
            display:grid;
            place-items:center;
            padding:24px;
            /* If your navbar/footer are fixed, this prevents overlap */
            padding-top: calc(24px + var(--navbar-h));
            padding-bottom: calc(24px + var(--footer-h));
        }

        .card{
            width:100%;
            max-width:760px;
            background:var(--card);
            border:1px solid var(--border);
            border-radius:var(--radius);
            box-shadow:var(--shadow);
            overflow:hidden;
        }

        .banner{
            display:flex; gap:16px; align-items:flex-start;
            padding:24px;
            background:var(--success-soft);
            border-bottom:1px solid var(--border);
        }
        .card.is-error .banner{ background:var(--error-soft); }

        .status-icon{
            display:grid; place-items:center;
            width:44px; height:44px; border-radius:999px;
            background:#fff; border:1px solid var(--border);
            flex:0 0 44px;
            color:var(--success);
        }
        .card.is-error .status-icon{ color:var(--error); }

        .banner h1{
            margin:0 0 6px; font-size:22px; line-height:1.25;
        }
        .subtitle{color:var(--muted); margin:0}

        .content{ padding:24px; }

        .details{
            display:grid;
            grid-template-columns: minmax(160px, 220px) 1fr;
            gap:10px 18px;
            margin-top:6px;
        }
        .details .label{ color:var(--muted) }

        .code{
            font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
            background:#f8fafc; border:1px solid var(--border);
            padding:4px 8px; border-radius:8px;
        }

        .amount{
            font-size:20px; font-weight:700;
        }

        .chip{
            display:inline-flex; align-items:center; gap:8px;
            padding:6px 10px; border-radius:999px; font-weight:600; font-size:13px;
            border:1px solid currentColor; color:var(--success); background:#fff;
        }
        .card.is-error .chip{ color:var(--error); }

        .hr{ height:1px; background:var(--border); margin:16px 0 18px; }

        .actions{
            display:flex; gap:12px; flex-wrap:wrap; margin-top:6px;
        }
        .btn{
            display:inline-flex; align-items:center; justify-content:center; gap:10px;
            padding:12px 16px; border-radius:12px; text-decoration:none; font-weight:600;
            border:1px solid transparent; cursor:pointer; transition:.15s transform ease;
        }
        .btn:active{ transform:translateY(1px) }
        .btn-primary{ background:var(--primary); color:#fff; }
        .btn-ghost{ background:#fff; color:var(--text); border-color:var(--border); }

        .note{ color:var(--muted); font-size:13px; margin-top:8px }

        @media (max-width:560px){
            .banner{ padding:18px }
            .content{ padding:18px }
            .details{ grid-template-columns: 1fr; }
            .status-icon{ width:40px; height:40px }
        }

        /* Optional: cleaner print of the receipt */
        @media print {
            body{ background:#fff }
            .main-center{ padding:0 }
            .card{ box-shadow:none; border:none; }
            .btn{ display:none !important; }
        }
    </style>
</head>
<body>
<div class="page-shell">
    <!-- Header (customer navbar fragment) -->
    <div th:replace="taskbar/customer-navbar :: customerNavbar"></div>

    <!-- Centered main content -->
    <main class="main-center">
        <div class="card" th:classappend="${success} ? ' is-success' : ' is-error'">

            <!-- Top status banner -->
            <div class="banner">
                <div class="status-icon" aria-hidden="true">
                    <!-- Check / X icon swaps color via parent class -->
                    <svg th:if="${success}" width="22" height="22" viewBox="0 0 24 24" fill="none">
                        <path d="M20 7L9 18l-5-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <svg th:unless="${success}" width="22" height="22" viewBox="0 0 24 24" fill="none">
                        <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                <div>
                    <h1>
                        Kết quả thanh toán VNPay:
                        <span class="chip" th:text="${success} ? 'Thành công' : 'Thất bại'">Thành công</span>
                    </h1>
                    <p class="subtitle" th:if="${success}">
                        Cảm ơn bạn! Giao dịch của bạn đã được xử lý thành công.
                    </p>
                    <p class="subtitle" th:unless="${success}">
                        Rất tiếc, thanh toán không thành công.
                        <span>Vui lòng thử lại hoặc liên hệ hỗ trợ.</span>
                    </p>
                </div>
            </div>

            <!-- Body -->
            <div class="content">
                <div class="details" role="list">
                    <div class="label">Mã giao dịch (VNPay)</div>
                    <div class="code" th:text="${vnp_TransactionNo} ?: '-'">123456</div>

                    <div class="label">Mã đơn của bạn (Order ID)</div>
                    <div class="code" th:text="${vnp_TxnRef} ?: '-'">45</div>

                    <div class="label">Nội dung đơn hàng</div>
                    <div th:text="${vnp_OrderInfo} ?: '-'">Thanh toán đơn hàng</div>

                    <div class="label">Số tiền</div>
                    <div class="amount" th:text="${#numbers.formatInteger(amountVnd, 0, 'COMMA')} + ' VNĐ'">100,000 VNĐ</div>

                    <div class="label">Trạng thái thanh toán</div>
                    <div>
                        <span th:if="${success}" style="color:var(--success); font-weight:700">Thành công</span>
                        <span th:unless="${success}" style="color:var(--error); font-weight:700">
                Thất bại (mã <span class="code" th:text="${vnp_ResponseCode}">00</span>)
              </span>
                    </div>
                </div>

                <div class="hr"></div>

                <div class="actions">
                    <a class="btn btn-primary" href="/SWP/customers/my-bookings">Về “Đơn hàng của tôi”</a>
                    <button class="btn btn-ghost" type="button" onclick="window.print()">In biên lai</button>
                </div>

                <p class="note" th:if="${!success}">
                    Gợi ý: Kiểm tra số dư / hạn mức thẻ, hoặc thử phương thức thanh toán khác.
                </p>
            </div>
        </div>
    </main>

    <!-- Footer (customer footer fragment) -->
    <div th:replace="taskbar/customer-footer :: customerFooter"></div>
</div>
</body>
</html>
